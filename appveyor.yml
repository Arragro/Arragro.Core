# Dev config
-
  branches:
    only:
      - /[Dd]ev/
  version: 1.0.0-alpha-{build}
  configuration: Release
  image: Visual Studio 2017
  services:
    - mssql2016
  nuget:
    account_feed: false
    project_feed: false
    disable_publish_on_pr: true
  assembly_info:
    patch: true
    file: AssemblyInfo.*
    assembly_version: $(appveyor_build_version)
    assembly_file_version: $(appveyor_build_version)
    assembly_informational_version: $(appveyor_build_version)
  dotnet_csproj:
    patch: true
    file: '**\*.csproj'
    version: $(appveyor_build_version)
    package_version: '{version}'
    assembly_version: $(appveyor_build_version)
    file_version: $(appveyor_build_version)
    informational_version: '{version}'
  environment:
    # Don't report back to the mothership
    DOTNET_CLI_TELEMETRY_OPTOUT: 1
    appveyor_build_version:  1.0.{build}
  init:
  - ps: $Env:LABEL = "alpha-build" + $Env:APPVEYOR_BUILD_NUMBER
  - ps: $Env:LABEL
  - ps: $Env:appveyor_build_version = "1.0." + $Env:APPVEYOR_BUILD_NUMBER
  - ps: $Env:appveyor_build_version
  before_build:
  - ps: >-
      $Env:LABEL

      C:\Tools\nuget\nuget.exe update -self

      nuget sources update -Name nuget.org -Source https://api.nuget.org/v3/index.json;

      appveyor-retry dotnet restore -v Minimal;

      nuget install redis-64 -excludeversion;

      redis-64\tools\redis-server.exe --service-install;

      redis-64\tools\redis-server.exe --service-start;
  test: on
  artifacts:  
    - path: .\artifacts\**\*.nupkg
      name: NuGet
  deploy:
  - provider: NuGet
    api_key:
      secure: F0ZPbEej7MlPRYAb43jRKMZdVDCWLEhfsgmx4o3YTSdcTKIGbOO92NL2LlHcjY1V
    on:
      branch: dev
  notifications:
  - provider: Slack
    auth_token:
      secure: ykFbdC7lkZWbEgA8/5cQo3c2+ISttLd1AvhAiXyJqd2eaCdR8p32kE2aHlTxmwFU
    channel: github
    on_build_success: true
    on_build_failure: true
    on_build_status_changed: true